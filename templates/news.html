<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Finance Trends Analysis Toolkit</title>    
    <link href="../static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/bootstrap/css/boostrap-datetimepicker.min.css">
    <link href="../static/css/style.css" rel="stylesheet">

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../static/bootstrap/js/bootstrap.min.js"></script>
    <script src="../static/js/moment.min.js"></script>
    
    <!-- amChart.js -->
    <script src="https://www.amcharts.com/lib/3/amcharts.js" type="text/javascript"></script>
    <script src="https://www.amcharts.com/lib/3/serial.js" type="text/javascript"></script>
    <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js" type="text/javascript"></script>
    <link href="https://www.amcharts.com/lib/3/plugins/export/export.css" rel="stylesheet" type="text/css" media="all" />
    <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>	

    <!-- amChart.js line chart-->
    <script src="https://www.amcharts.com/lib/3/themes/patterns.js" type="text/javascript"></script>
    <script type="text/javascript">

var chartData = generateChartData();

var chart = AmCharts.makeChart("chartdiv", {
    "type": "serial",
    "theme": "patterns",
    "legend": {
        "useGraphSettings": true
    },
    "dataProvider": chartData,
    "synchronizeGrid":true,
    "valueAxes": [{
        "id":"v1",
        "axisColor": "#FF6600",
        "axisThickness": 2,
        "axisAlpha": 1,
        "position": "left"
    }, {
        "id":"v2",
        "axisColor": "#FCD202",
        "axisThickness": 2,
        "axisAlpha": 1,
        "position": "right"
    }, {
        "id":"v3",
        "axisColor": "#B0DE09",
        "axisThickness": 2,
        "gridAlpha": 0,
        "offset": 50,
        "axisAlpha": 1,
        "position": "left"
    }, {
        "id":"v4",
        "axisColor": "#0000E5",
        "axisThickness": 2,
        "gridAlpha": 0,
        "offset": 50,
        "axisAlpha": 1,
        "position": "right"
    }],
    "graphs": [{
        "valueAxis": "v1",
        "lineColor": "#FF6600",
        "bullet": "round",
        "bulletBorderThickness": 1,
        "hideBulletsCount": 30,
        "title": "ASX1",
        "valueField": "a",
		"fillAlphas": 0
    }, {
        "valueAxis": "v2",
        "lineColor": "#FCD202",
        "bullet": "square",
        "bulletBorderThickness": 1,
        "hideBulletsCount": 30,
        "title": "ASX2",
        "valueField": "b",
		"fillAlphas": 0
    }, {
        "valueAxis": "v3",
        "lineColor": "#B0DE09",
        "bullet": "triangleUp",
        "bulletBorderThickness": 1,
        "hideBulletsCount": 30,
        "title": "ASX3",
        "valueField": "c",
		"fillAlphas": 0
    }, {
        "valueAxis": "v4",
        "lineColor": "#0000E5",
        "bullet": "triangleUp",
        "bulletBorderThickness": 1,
        "hideBulletsCount": 30,
        "title": "ASX4",
        "valueField": "d",
		"fillAlphas": 0
        }],
    "chartScrollbar": {},
    "chartCursor": {
        "cursorPosition": "mouse"
    },
    "categoryField": "date",
    "categoryAxis": {
        "parseDates": true,
        "axisColor": "#DADADA",
        "minorGridEnabled": true
    },
    "export": {
    	"enabled": true,
        "position": "bottom-right"
     }
});

chart.addListener("dataUpdated", zoomChart);
zoomChart();


// generate some random data, quite different range
function generateChartData() {
    var chartData = {{ comparison|safe}};
    return chartData;
}

function zoomChart(){
    chart.zoomToIndexes(chart.dataProvider.length - 20, chart.dataProvider.length - 1);
}

    </script>

    <!-- amChart.js candlestick chart-->
    <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>	
    <script type="text/javascript">
    var cData = {{ qu|safe }};

    var chart = AmCharts.makeChart( "chartdiv2", {
      "type": "serial",
      "theme": "light",
      "dataDateFormat":"YYYY-MM-DD",
      "valueAxes": [ {
        "position": "left"
      } ],
      "graphs": [ {
        "id": "g1",
        "proCandlesticks": true,
        "balloonText": "Open:<b>[[open]]</b><br>Low:<b>[[low]]</b><br>High:<b>[[high]]</b><br>Close:<b>[[close]]</b><br>",
        "closeField": "close",
        "fillColors": "#7f8da9",
        "highField": "high",
        "lineColor": "#7f8da9",
        "lineAlpha": 1,
        "lowField": "low",
        "fillAlphas": 0.9,
        "negativeFillColors": "#db4c3c",
        "negativeLineColor": "#db4c3c",
        "openField": "open",
        "title": "Price:",
        "type": "candlestick",
        "valueField": "close"
      } ],
      "chartScrollbar": {
        "graph": "g1",
        "graphType": "line",
        "scrollbarHeight": 30
      },
      "chartCursor": {
        "valueLineEnabled": true,
        "valueLineBalloonEnabled": true
      },
      "categoryField": "date",
      "categoryAxis": {
        "parseDates": true
      },
      "dataProvider": cData,
      "export": {
        "enabled": true,
        "position": "bottom-right"
      }
    } );

    chart.addListener( "rendered", zoomChart );
    zoomChart();
        
    // this method is called when chart is first inited as we listen for "dataUpdated" event
    function zoomChart() {
      // different zoom methods can be used - zoomToIndexes, zoomToDates, zoomToCategoryValues
      chart.zoomToIndexes( chart.dataProvider.length - 50, chart.dataProvider.length - 1 );
    }
    </script>
  </head>
  <body>
    <!-- start header -->

    <nav class="navbar navbar-default col-md-12">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Brand</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">Link <span class="sr-only">(current)</span></a></li>
        <li><a href="#">Link</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<!-- end header -->

<!-- start name -->
<!-- this div will have company name and company code in it -->
<div class="name col-md-12">
  <h3>{{ cn }}<span class="label label-default"> ASX200:{{ cc }}</span></h3>
</div>
<!-- end name -->

<!-- start dates -->
<!-- TODO: date picking -->
<div class="dates col-xs-12">
        <div id="content">
            <form method="post" action="/">
                <label for="fromdate">From Date</label>
                <input type="date" name="fromdate" /><br />
                <label for="todate">To Date:</label>
                <input type="date" name="todate" /><br />
                <label for="todate">Keyword:</label>
                <input type="text" name="keyword" /><br />
                <input type="submit" />
            </form>
        </div>
  </div>

<!-- end dates -->

<!-- start main -->
<div class="main-section col-xs-12">
    <div class="col-md-4 col-xs-12">
        <div class="panel panel-default">
            <!-- Default panel contents: put stuff here from Jinja -->
                <div class="panel-heading">Company Information</div>

                     <table class="table">
                            <tr>
                                <th>Price</th>
                                <td> {{ late["Price"] }} </td>
                            </tr>
                            <tr>
                                <th>Change from Previous Price</th>
                                <td> {{ late["Change from Previous Price"] }} </td>
                            </tr>
                            <tr>
                                <th>Market Cap</th>
                                <td> {{ late["Market Cap"] }} </td>
                            </tr>
                            <tr>
                                <th>Earnings Per Share</th>
                                <td> {{ late["Earnings Per Share"] }} </td>
                            </tr>
                            <tr>
                                <th>Price-Earnings Growth Ratio</th>
                                <td> {{ late["Price-Earnings Growth Ratio"] }} </td>
                            </tr>
                            <tr>
                                <th>Price-Earnings Ratio</th>
                                <td> {{ late["Price-Earnings Ratio"] }} </td>
                            </tr>
                            <tr>
                                <th>Price-Sales Ratio</th>
                                <td> {{ late["Price-Sales Ratio"] }} </td>
                            </tr>
                            <tr>
                                <th>Yearly High</th>
                                <td> {{ late["Yearly High"] }} </td>
                            </tr>
                            <tr>
                                <th>Yearly Low</th>
                                <td> {{ late["Yearly Low"] }} </td>
                            </tr>
                            <tr>
                                <th>Fifty-Day Moving Average</th>
                                <td> {{ late["Fifty-Day Moving Average"] }} </td>
                            </tr>
                            <tr>
                                <th>Two Hundred-Day Moving Average</th>
                                <td> {{ late["Two Hundred-Day Moving Average"] }} </td>
                            </tr>
                            <tr>
                                <th>Volume</th>
                                <td> {{ late["Volume"] }} </td>
                            </tr>
                            <tr>
                                <th>Volume (Avg)</th>
                                <td> {{ late["Volume (Avg)"] }} </td>
                            </tr>
                    </table>
                </div>
            <div class="panel panel-default">
                <div class="panel-heading">Historical Prices</div>
                    <table class="table">                     
                        <thead> 
                            <tr>
                                <th>Date</th>
                                <th>Close</th>
                                <th>Open</th>
                                <th>High</th>
                                <th>Low</th>
                            </tr>
                        </thead> 
                        <tbody>
                        {% for item in qu %}
                            <tr>
                                <td> {{ item["date"] }} </td>
                                <td> {{ item["close"] }} </td>
                                <td> {{ item["open"] }} </td>
                                <td> {{ item["high"] }} </td>
                                <td> {{ item["low"] }} </td>
                            </tr>
                        {% endfor %}
                        </tbody> 
                    </table>
            </div>
        </div>
    <div class="main-content col-md-7 col-xs-12">
        <h2>Historical Data</h2>
        <div id="chartdiv2" style = "width:100%; height:500px; font-size:11px;"></div>
        <h2>Sector Comparison: {{ sec }}</h2>
        <div class="panel panel-default">
                    <table class="table">                     
                        <thead> 
                            <tr>
                                <th>Legend</th>                            
                                <th><b>ASX1: {{ cc }}</b></th>
                                <th><b>ASX2: {{ c1 }}</b></th>
                                <th><b>ASX3: {{ c2 }}</b></th>
                                <th><b>ASX4: {{ c3 }}</b></th>
                            </tr>
                        </thead> 
                        <tbody>
                            <tr>
                                <td> Market Cap </td>
                                <td> {{ markc }} </td>
                                <td> {{ cm1 }} </td>
                                <td> {{ cm2 }} </td>
                                <td> {{ cm3 }} </td>                                
                            </tr>
                        </tbody> 
                    </table>
            </div>
        <div id="chartdiv" style="height:500px; width:100%;"></div>
    </div>
    <div class="description col-md-12 col-xs-12">
        <div class="well">
            <h5>Market Sentiment: <span class="label label-success">Bullish</span></h5>
            <p>For the duration of 30 days, stock for company, {{ cn }} <span class="label label-primary">ASX200: {{ cc }}</span> has <span class="label label-success">increased by 5.54%.</span></p>
            <p>For the given time, it showed relatively <span class="label label-success">low volatility of 8.5%</span>, when compared to the ASX200 average of 18.5%, which is <span class="label label-success">10.0% lower than average</span>. </p>
            <p>High was achieved on 2/10/2014 and was <span class="label label-success">$AU132.50</span>, lowest price was <span class="label label-danger">$AU146.50</span> on the 1/9/2014. Overall, stock has increased in price 24 times and decreased in price 6 times.</p>
         </div>
    </div>
    <div class="main-content col-md-6 col-xs-12">
            <div class="panel panel-default">
                <div class="panel-heading">News Articles</div>
                    <table class="table">                     
                        <thead> 
                            <tr>
                                <th>Date</th>
                                <th>Link</th>
                                <th>Title</th>
                                <th>Summary</th>
                                <th>Sentiment</th>
                            </tr>
                        </thead> 
                        <tbody>
                        {% for item in articles %}
                            <tr>
                                <td> {{ item["Date"] }} </td>
                                <td><a href="{{ item["URL"] }}">Link</a></td>
                                <td> {{ item["Title"] }} </td>
                                <td> {{ item["Body"] }} </td>
                                <td> {{ item["Sentiment"] }} </td>
                            </tr>
                        {% endfor %}
                        </tbody> 
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end main -->

  </body>
</html>
